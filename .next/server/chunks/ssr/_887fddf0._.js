module.exports=[77192,a=>{"use strict";var b=a.i(72131),c=a.i(70121),d=a.i(72752),e=a=>{var e;let g,h,{present:i,children:j}=a,k=function(a){var c,e;let[g,h]=b.useState(),i=b.useRef(null),j=b.useRef(a),k=b.useRef("none"),[l,m]=(c=a?"mounted":"unmounted",e={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},b.useReducer((a,b)=>e[a][b]??a,c));return b.useEffect(()=>{let a=f(i.current);k.current="mounted"===l?a:"none"},[l]),(0,d.useLayoutEffect)(()=>{let b=i.current,c=j.current;if(c!==a){let d=k.current,e=f(b);a?m("MOUNT"):"none"===e||b?.display==="none"?m("UNMOUNT"):c&&d!==e?m("ANIMATION_OUT"):m("UNMOUNT"),j.current=a}},[a,m]),(0,d.useLayoutEffect)(()=>{if(g){let a,b=g.ownerDocument.defaultView??window,c=c=>{let d=f(i.current).includes(c.animationName);if(c.target===g&&d&&(m("ANIMATION_END"),!j.current)){let c=g.style.animationFillMode;g.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===g.style.animationFillMode&&(g.style.animationFillMode=c)})}},d=a=>{a.target===g&&(k.current=f(i.current))};return g.addEventListener("animationstart",d),g.addEventListener("animationcancel",c),g.addEventListener("animationend",c),()=>{b.clearTimeout(a),g.removeEventListener("animationstart",d),g.removeEventListener("animationcancel",c),g.removeEventListener("animationend",c)}}m("ANIMATION_END")},[g,m]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:b.useCallback(a=>{i.current=a?getComputedStyle(a):null,h(a)},[])}}(i),l="function"==typeof j?j({present:k.isPresent}):b.Children.only(j),m=(0,c.useComposedRefs)(k.ref,(e=l,(h=(g=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in g&&g.isReactWarning)?e.ref:(h=(g=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in g&&g.isReactWarning)?e.props.ref:e.props.ref||e.ref));return"function"==typeof j||k.isPresent?b.cloneElement(l,{ref:m}):null};function f(a){return a?.animationName||"none"}e.displayName="Presence",a.s(["Presence",()=>e])},1027,a=>{"use strict";let b=(0,a.i(70106).default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>b],1027)},58682,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(20237);let d="studentUsers",e="studentSessions";async function f(a){let b=new TextEncoder().encode(a+"myark_salt_2026");return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>a.toString(16).padStart(2,"0")).join("")}async function g(a,b){return await f(a)===b}let h={async register(a,e){try{let g=a.replace(/\D/g,"");if(10!==g.length)return{success:!1,error:"Please enter a valid 10-digit mobile number",errorCode:"INVALID_PHONE"};if(!/^\d{4}$/.test(e))return{success:!1,error:"PIN must be 4 digits",errorCode:"INVALID_PIN"};let h=(0,b.query)((0,b.collection)(c.db,d),(0,b.where)("phone","==",g));if(!(await (0,b.getDocs)(h)).empty)return{success:!1,error:"This number is already registered. Try logging in!",errorCode:"PHONE_EXISTS"};let i=await f(e),j=`user_${g}_${Date.now()}`,k=new Date,l={id:j,phone:g,xpPoints:50,level:1,streakDays:1,badges:["early_bird"],interests:[],appliedOpportunities:[],savedOpportunities:[],isVerified:!0,isBlocked:!1,failedLoginAttempts:0,lastLoginAt:k,createdAt:k,createdVia:"web"};await (0,b.setDoc)((0,b.doc)(c.db,d,j),{...l,pinHash:i,createdAt:b.Timestamp.fromDate(k),lastLoginAt:b.Timestamp.fromDate(k)});let m=await this.createSession(j);return{success:!0,user:l,session:m}}catch(a){return console.error("Registration error:",a),{success:!1,error:"Something went wrong. Please try again!"}}},async login(a,e){try{let f=a.replace(/\D/g,"");if(10!==f.length)return{success:!1,error:"Please enter a valid 10-digit mobile number",errorCode:"INVALID_PHONE"};let h=(0,b.query)((0,b.collection)(c.db,d),(0,b.where)("phone","==",f)),i=await (0,b.getDocs)(h);if(i.empty)return{success:!1,error:"No account found with this number. Want to register?",errorCode:"USER_NOT_FOUND"};let j=i.docs[0],k=j.data();if(k.isBlocked)return{success:!1,error:"Your account has been blocked. Contact support for help.",errorCode:"BLOCKED"};let l=await this.checkRateLimit(k);if(!l.allowed){let a=Math.ceil((l.lockoutUntil.getTime()-Date.now())/6e4);return{success:!1,error:`Too many attempts! Take a break for ${a} min â˜•`,errorCode:"RATE_LIMITED"}}if(!await g(e,k.pinHash)){await this.incrementFailedAttempts(j.id);let a=5-(k.failedLoginAttempts+1);return{success:!1,error:a>0?`Wrong PIN! ${a} attempts left ðŸŽ¯`:"Wrong PIN! Account locked for 5 minutes.",errorCode:"WRONG_PIN"}}let m=function(a,b){if(!a)return 1;let c=new Date,d=new Date(a);d.setHours(0,0,0,0);let e=new Date(c);e.setHours(0,0,0,0);let f=Math.round((e.getTime()-d.getTime())/864e5);return 1===f?b+1:f>1?1:b||1}(k.lastLoginAt?.toDate(),k.streakDays||0);await (0,b.updateDoc)((0,b.doc)(c.db,d,j.id),{failedLoginAttempts:0,lastLoginAt:b.Timestamp.now(),streakDays:m,xpPoints:(0,b.increment)(10)});let n=await this.createSession(j.id),o={id:j.id,phone:k.phone,name:k.name,grade:k.grade,school:k.school,city:k.city,state:k.state,profilePicture:k.profilePicture,gender:k.gender,interests:k.interests||[],appliedOpportunities:k.appliedOpportunities||[],savedOpportunities:k.savedOpportunities||[],xpPoints:(k.xpPoints||0)+10,level:k.level||1,streakDays:m,badges:k.badges||[],isVerified:k.isVerified||!0,isBlocked:!1,failedLoginAttempts:0,lastLoginAt:new Date,createdAt:k.createdAt?.toDate()||new Date,createdVia:k.createdVia||"web"};return{success:!0,user:o,session:n}}catch(a){return console.error("Login error:",a),{success:!1,error:"Something went wrong. Please try again!"}}},async createSession(a){let d,f,g,{device:h,browser:i}=(d=navigator.userAgent,f="Unknown Device",g="Unknown Browser",/iPhone/i.test(d)?f="iPhone":/iPad/i.test(d)?f="iPad":/Android/i.test(d)?f="Android":/Windows/i.test(d)?f="Windows":/Mac/i.test(d)?f="Mac":/Linux/i.test(d)&&(f="Linux"),/Chrome/i.test(d)&&!/Edg/i.test(d)?g="Chrome":/Safari/i.test(d)&&!/Chrome/i.test(d)?g="Safari":/Firefox/i.test(d)?g="Firefox":/Edg/i.test(d)&&(g="Edge"),{device:f,browser:g}),j=`session_${a}_${Date.now()}`,k=new Date,l={id:j,userId:a,device:h,browser:i,createdAt:k,lastActiveAt:k,isActive:!0};return await (0,b.setDoc)((0,b.doc)(c.db,e,j),{...l,createdAt:b.Timestamp.fromDate(k),lastActiveAt:b.Timestamp.fromDate(k)}),localStorage.setItem("myark_session",j),localStorage.setItem("myark_user_id",a),l},async validateSession(a){try{let f=await (0,b.getDoc)((0,b.doc)(c.db,e,a));if(!f.exists())return null;let g=f.data();if(!g.isActive)return null;let h=g.createdAt?.toDate()||new Date,i=new Date(h.getTime()+2592e6);if(new Date>i)return await this.terminateSession(a),null;let j=await (0,b.getDoc)((0,b.doc)(c.db,d,g.userId));if(!j.exists())return null;let k=j.data();if(k.isBlocked)return null;return await (0,b.updateDoc)((0,b.doc)(c.db,e,a),{lastActiveAt:b.Timestamp.now()}),{id:j.id,phone:k.phone,name:k.name,grade:k.grade,school:k.school,city:k.city,state:k.state,profilePicture:k.profilePicture,gender:k.gender,interests:k.interests||[],appliedOpportunities:k.appliedOpportunities||[],savedOpportunities:k.savedOpportunities||[],xpPoints:k.xpPoints||0,level:k.level||1,streakDays:k.streakDays||0,badges:k.badges||[],isVerified:k.isVerified||!0,isBlocked:!1,failedLoginAttempts:0,lastLoginAt:k.lastLoginAt?.toDate(),createdAt:k.createdAt?.toDate()||new Date,createdVia:k.createdVia||"web"}}catch(a){return console.error("Session validation error:",a),null}},async terminateSession(a){try{await (0,b.updateDoc)((0,b.doc)(c.db,e,a),{isActive:!1})}catch(a){console.error("Session termination error:",a)}},async logout(){let a=localStorage.getItem("myark_session");a&&await this.terminateSession(a),localStorage.removeItem("myark_session"),localStorage.removeItem("myark_user_id")},async checkRateLimit(a){let b=a.failedLoginAttempts||0,c=a.lastFailedAttempt?.toDate();if(b>=5&&c){let a=new Date(c.getTime()+3e5);if(new Date<a)return{allowed:!1,remainingAttempts:0,lockoutUntil:a}}return{allowed:!0,remainingAttempts:5-b}},async incrementFailedAttempts(a){await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{failedLoginAttempts:(0,b.increment)(1),lastFailedAttempt:b.Timestamp.now()})},async getAllUsers(a){try{let e=(0,b.collection)(c.db,d),f=(await (0,b.getDocs)(e)).docs.map(a=>{let b=a.data();return{id:a.id,phone:b.phone,name:b.name,grade:b.grade,school:b.school,city:b.city,xpPoints:b.xpPoints||0,level:b.level||1,streakDays:b.streakDays||0,badges:b.badges||[],isVerified:b.isVerified||!0,isBlocked:b.isBlocked||!1,blockReason:b.blockReason,failedLoginAttempts:b.failedLoginAttempts||0,lastLoginAt:b.lastLoginAt?.toDate(),lastFailedAttempt:b.lastFailedAttempt?.toDate(),createdAt:b.createdAt?.toDate()||new Date,createdVia:b.createdVia||"web",personaGoal:b.personaGoal,competitiveness:b.competitiveness,weeklyTimeCommitment:b.weeklyTimeCommitment,deliveryPreference:b.deliveryPreference,interests:b.interests||[],appliedOpportunities:b.appliedOpportunities||[],savedOpportunities:b.savedOpportunities||[],email:b.email}});if(a?.search){let b=a.search.toLowerCase();f=f.filter(a=>a.phone.includes(b)||a.name?.toLowerCase().includes(b))}return a?.blocked!==void 0&&(f=f.filter(b=>b.isBlocked===a.blocked)),f.sort((a,b)=>b.createdAt.getTime()-a.createdAt.getTime())}catch(a){return console.error("Error fetching users:",a),[]}},async getUserSessions(a){try{let d=(0,b.query)((0,b.collection)(c.db,e),(0,b.where)("userId","==",a));return(await (0,b.getDocs)(d)).docs.map(a=>{let b=a.data();return{id:a.id,userId:b.userId,device:b.device,browser:b.browser,createdAt:b.createdAt?.toDate()||new Date,lastActiveAt:b.lastActiveAt?.toDate()||new Date,isActive:b.isActive}}).sort((a,b)=>b.lastActiveAt.getTime()-a.lastActiveAt.getTime())}catch(a){return console.error("Error fetching sessions:",a),[]}},async blockUser(a,e){for(let f of(await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{isBlocked:!0,blockReason:e}),await this.getUserSessions(a)))await this.terminateSession(f.id)},async unblockUser(a){await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{isBlocked:!1,blockReason:null,failedLoginAttempts:0})},async resetUserPin(a,e){let g=await f(e);await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{pinHash:g,failedLoginAttempts:0})},async terminateAllUserSessions(a){for(let b of(await this.getUserSessions(a)))await this.terminateSession(b.id)},async updateUserXP(a,e){await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{xpPoints:(0,b.increment)(e)})},async updateProfile(a,e){let f=["name","profilePicture","grade","school","city","state","gender","interests","personaGoal","competitiveness","weeklyTimeCommitment","deliveryPreference","badges"],g={};for(let[a,b]of Object.entries(e))f.includes(a)&&void 0!==b&&(g[a]=b);Object.keys(g).length>0&&await (0,b.updateDoc)((0,b.doc)(c.db,d,a),g)},async saveOpportunity(e,f){let{arrayUnion:g}=await a.A(28162);await (0,b.updateDoc)((0,b.doc)(c.db,d,e),{savedOpportunities:g(f),xpPoints:(0,b.increment)(5)})},async unsaveOpportunity(e,f){let{arrayRemove:g}=await a.A(28162);await (0,b.updateDoc)((0,b.doc)(c.db,d,e),{savedOpportunities:g(f)})},async applyToOpportunity(e,f){let{arrayUnion:g}=await a.A(28162),h=(0,b.doc)(c.db,d,e),i=(0,b.doc)(c.db,"opportunities",f);await (0,b.updateDoc)(h,{appliedOpportunities:g(f),xpPoints:(0,b.increment)(40)}),await (0,b.updateDoc)(i,{applicationCount:(0,b.increment)(1)})},async addProfileXP(a,e){await (0,b.updateDoc)((0,b.doc)(c.db,d,a),{xpPoints:(0,b.increment)(e)})}};a.s(["default",0,h,"studentAuthService",0,h])}];

//# sourceMappingURL=_887fddf0._.js.map