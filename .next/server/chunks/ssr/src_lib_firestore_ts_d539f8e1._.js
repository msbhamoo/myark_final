module.exports=[25101,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(20237);let d={opportunities:"opportunities",blogs:"blogs",careers:"careers",students:"studentUsers",schoolDemos:"schoolDemos",notifications:"notifications",badges:"badges",settings:"settings",organizers:"organizers",leads:"studentLeads"},e=a=>{if(a)return a instanceof b.Timestamp?a.toDate():a},f=a=>{if(!a)return null;if(a instanceof b.Timestamp)return a;try{let c=new Date(a);return isNaN(c.getTime())?null:b.Timestamp.fromDate(c)}catch(a){return null}},g=a=>{let b={};return Object.keys(a).forEach(c=>{void 0!==a[c]&&(b[c]=a[c])}),b},h={async getAll(a){let f=[(0,b.orderBy)("createdAt","desc")];a?.grade&&f.push((0,b.where)("grade","==",a.grade)),a?.limit&&f.push((0,b.limit)(a.limit));let g=(0,b.query)((0,b.collection)(c.db,d.students),...f);return(await (0,b.getDocs)(g)).docs.map(a=>{let b=a.data();return{id:a.id,...b,createdAt:e(b.createdAt),lastActiveAt:e(b.lastActiveAt||b.lastLoginAt)}})},async getById(a){let f=(0,b.doc)(c.db,d.students,a),g=await (0,b.getDoc)(f);return g.exists()?{id:g.id,...g.data(),createdAt:e(g.data().createdAt),lastActiveAt:e(g.data().lastActiveAt)}:null},async getStats(){let a=(await (0,b.getDocs)((0,b.collection)(c.db,d.students))).docs.map(a=>a.data()),f=new Date(new Date().getTime()-6048e5);return{total:a.length,activeThisWeek:a.filter(a=>{let b=e(a.lastActiveAt);return b&&b>=f}).length,avgStreak:a.length>0?Math.round(a.reduce((a,b)=>a+(b.streakDays||0),0)/a.length):0}},async assignBadge(a,e){let f=(0,b.doc)(c.db,d.students,a);await (0,b.updateDoc)(f,{badges:(0,b.arrayUnion)(e),updatedAt:b.Timestamp.now()})},async removeBadge(a,e){let f=(0,b.doc)(c.db,d.students,a);await (0,b.updateDoc)(f,{badges:(0,b.arrayRemove)(e),updatedAt:b.Timestamp.now()})}},i={async getAll(a){let f=[(0,b.orderBy)("createdAt","desc")];a?.status&&"all"!==a.status&&f.push((0,b.where)("status","==",a.status));let g=(0,b.query)((0,b.collection)(c.db,d.schoolDemos),...f);return(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data(),scheduledDate:e(a.data().scheduledDate),createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)}))},create:async a=>(await (0,b.addDoc)((0,b.collection)(c.db,d.schoolDemos),{...a,status:a.status||"pending",createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()})).id,async updateStatus(a,e,f){let g=(0,b.doc)(c.db,d.schoolDemos,a);await (0,b.updateDoc)(g,{status:e,notes:f||null,updatedAt:b.Timestamp.now()})},async getCountByStatus(){let a=await (0,b.getDocs)((0,b.collection)(c.db,d.schoolDemos)),e={pending:0,contacted:0,scheduled:0,completed:0,rejected:0};return a.docs.forEach(a=>{let b=a.data().status;void 0!==e[b]&&e[b]++}),e}};a.s(["COLLECTIONS",0,d,"badgesService",0,{async getAll(){let a=(0,b.query)((0,b.collection)(c.db,d.badges),(0,b.orderBy)("createdAt","desc"));return(await (0,b.getDocs)(a)).docs.map(a=>({id:a.id,...a.data(),createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)}))},async getById(a){let f=(0,b.doc)(c.db,d.badges,a),g=await (0,b.getDoc)(f);return g.exists()?{id:g.id,...g.data(),createdAt:e(g.data().createdAt),updatedAt:e(g.data().updatedAt)}:null},async create(a){let e=g(a);return(await (0,b.addDoc)((0,b.collection)(c.db,d.badges),{...e,createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()})).id},async update(a,e){let f=(0,b.doc)(c.db,d.badges,a);await (0,b.updateDoc)(f,{...g(e),updatedAt:b.Timestamp.now()})},async delete(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.badges,a))}},"blogsService",0,{async getAll(a){let f=[];a?.status&&"all"!==a.status&&f.push((0,b.where)("status","==",a.status)),a?.limit&&f.push((0,b.limit)(a.limit));let g=(0,b.query)((0,b.collection)(c.db,d.blogs),...f);return(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data(),publishedAt:e(a.data().publishedAt),createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)}))},async getById(a){let f=(0,b.doc)(c.db,d.blogs,a),g=await (0,b.getDoc)(f);return g.exists()?{id:g.id,...g.data(),publishedAt:e(g.data().publishedAt),createdAt:e(g.data().createdAt),updatedAt:e(g.data().updatedAt)}:null},async getBySlug(a){let f=(0,b.query)((0,b.collection)(c.db,d.blogs),(0,b.where)("slug","==",a),(0,b.limit)(1)),g=await (0,b.getDocs)(f);if(g.empty)return null;let h=g.docs[0];return{id:h.id,...h.data(),publishedAt:e(h.data().publishedAt),createdAt:e(h.data().createdAt),updatedAt:e(h.data().updatedAt)}},create:async a=>(await (0,b.addDoc)((0,b.collection)(c.db,d.blogs),{...a,viewCount:0,publishedAt:"published"===a.status?b.Timestamp.now():null,createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()})).id,async update(a,e){let f=(0,b.doc)(c.db,d.blogs,a);await (0,b.updateDoc)(f,g({...e,updatedAt:b.Timestamp.now()}))},async delete(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.blogs,a))}},"careersService",0,{async getAll(a){let f=[(0,b.orderBy)("createdAt","desc")];a?.status&&"all"!==a.status&&f.push((0,b.where)("status","==",a.status)),a?.limit&&f.push((0,b.limit)(a.limit));let g=(0,b.query)((0,b.collection)(c.db,d.careers),...f);return(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data(),postedAt:e(a.data().postedAt),expiresAt:e(a.data().expiresAt),createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)}))},async getById(a){let f=(0,b.doc)(c.db,d.careers,a),g=await (0,b.getDoc)(f);return g.exists()?{id:g.id,...g.data(),postedAt:e(g.data().postedAt),expiresAt:e(g.data().expiresAt),createdAt:e(g.data().createdAt),updatedAt:e(g.data().updatedAt)}:null},async getBySlug(a){let f=(0,b.query)((0,b.collection)(c.db,d.careers),(0,b.where)("slug","==",a),(0,b.limit)(1)),g=await (0,b.getDocs)(f);if(g.empty)return null;let h=g.docs[0];return{id:h.id,...h.data(),postedAt:e(h.data().postedAt),expiresAt:e(h.data().expiresAt),createdAt:e(h.data().createdAt),updatedAt:e(h.data().updatedAt)}},create:async a=>(await (0,b.addDoc)((0,b.collection)(c.db,d.careers),{...a,applicationCount:0,postedAt:b.Timestamp.now(),createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()})).id,async update(a,e){let f=(0,b.doc)(c.db,d.careers,a);await (0,b.updateDoc)(f,g({...e,updatedAt:b.Timestamp.now()}))},async delete(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.careers,a))}},"dashboardService",0,{async getStats(){let[a,e,f]=await Promise.all([(0,b.getDocs)((0,b.collection)(c.db,d.opportunities)),h.getStats(),i.getCountByStatus()]),g=a.docs.filter(a=>"published"===a.data().status).length;return{totalOpportunities:a.size,publishedOpportunities:g,totalStudents:e.total,activeStudents:e.activeThisWeek,pendingDemos:f.pending}}},"leadsService",0,{async getAll(a){try{let f=[];a?.converted!==void 0&&f.push((0,b.where)("converted","==",a.converted)),a?.limit&&f.push((0,b.limit)(a.limit));try{let a=(0,b.query)((0,b.collection)(c.db,d.leads),...f,(0,b.orderBy)("createdAt","desc"));return(await (0,b.getDocs)(a)).docs.map(a=>{let b=a.data();return{id:a.id,...b,createdAt:e(b.createdAt),convertedAt:e(b.convertedAt)}})}catch(g){console.warn("Leads fetch with orderBy failed (likely missing index), falling back to unsorted:",g);let a=(0,b.query)((0,b.collection)(c.db,d.leads),...f);return(await (0,b.getDocs)(a)).docs.map(a=>{let b=a.data();return{id:a.id,...b,createdAt:e(b.createdAt),convertedAt:e(b.convertedAt)}}).sort((a,b)=>(b.createdAt?.getTime()||0)-(a.createdAt?.getTime()||0))}}catch(a){return console.error("Error in leadsService.getAll:",a),[]}},async getStats(){try{let a=(await (0,b.getDocs)((0,b.collection)(c.db,d.leads))).docs.map(a=>a.data());return{total:a.length,converted:a.filter(a=>a.converted).length,abandoned:a.filter(a=>!a.converted).length}}catch(a){return console.error("Error in leadsService.getStats:",a),{total:0,converted:0,abandoned:0}}},async delete(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.leads,a))}},"notificationsService",0,{async getAll(){let a=(0,b.query)((0,b.collection)(c.db,d.notifications),(0,b.orderBy)("createdAt","desc"));return(await (0,b.getDocs)(a)).docs.map(a=>({id:a.id,...a.data(),scheduledFor:e(a.data().scheduledFor),sentAt:e(a.data().sentAt),createdAt:e(a.data().createdAt)}))},send:async a=>(await (0,b.addDoc)((0,b.collection)(c.db,d.notifications),g({...a,sentAt:b.Timestamp.now(),createdAt:b.Timestamp.now()}))).id},"opportunitiesService",0,{async getAll(a){let f=[];a?.type&&"all"!==a.type&&f.push((0,b.where)("type","==",a.type)),a?.status&&"all"!==a.status&&f.push((0,b.where)("status","==",a.status)),a?.limit&&f.push((0,b.limit)(a.limit));let g=(0,b.query)((0,b.collection)(c.db,d.opportunities),...f);return(await (0,b.getDocs)(g)).docs.map(a=>({id:a.id,...a.data(),dates:{registrationStart:e(a.data().dates?.registrationStart),registrationEnd:e(a.data().dates?.registrationEnd),eventDate:e(a.data().dates?.eventDate)},createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)}))},async getById(a){let f=(0,b.doc)(c.db,d.opportunities,a),g=await (0,b.getDoc)(f);return g.exists()?{id:g.id,...g.data(),dates:{registrationStart:e(g.data().dates?.registrationStart),registrationEnd:e(g.data().dates?.registrationEnd),eventDate:e(g.data().dates?.eventDate)},createdAt:e(g.data().createdAt),updatedAt:e(g.data().updatedAt)}:null},async create(a){let e=g(a);return(await (0,b.addDoc)((0,b.collection)(c.db,d.opportunities),{...e,dates:{registrationStart:f(a.dates.registrationStart),registrationEnd:f(a.dates.registrationEnd),eventDate:f(a.dates.eventDate)},hypeCount:0,applicationCount:0,createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()})).id},async update(a,e){let h=(0,b.doc)(c.db,d.opportunities,a),i=g({...e,updatedAt:b.Timestamp.now()});e.dates&&(i.dates={registrationStart:f(e.dates.registrationStart),registrationEnd:f(e.dates.registrationEnd),eventDate:f(e.dates.eventDate)}),await (0,b.updateDoc)(h,i)},async hypeOpportunity(a){let e=(0,b.doc)(c.db,d.opportunities,a);await (0,b.updateDoc)(e,{hypeCount:(0,b.increment)(1)})},async shareOpportunity(a){let e=(0,b.doc)(c.db,d.opportunities,a);await (0,b.updateDoc)(e,{shareCount:(0,b.increment)(1)})},async incrementView(a){let e=(0,b.doc)(c.db,d.opportunities,a);await (0,b.updateDoc)(e,{viewCount:(0,b.increment)(1)})},async incrementApplication(a){let e=(0,b.doc)(c.db,d.opportunities,a);await (0,b.updateDoc)(e,{applicationCount:(0,b.increment)(1)})},async syncApplicationCount(a){let e=(0,b.query)((0,b.collection)(c.db,"studentUsers"),(0,b.where)("appliedOpportunities","array-contains",a)),f=(await (0,b.getDocs)(e)).size,g=(0,b.doc)(c.db,d.opportunities,a);return await (0,b.updateDoc)(g,{applicationCount:f}),f},async delete(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.opportunities,a))},subscribe(a){let f=(0,b.query)((0,b.collection)(c.db,d.opportunities),(0,b.where)("status","==","published"),(0,b.orderBy)("createdAt","desc"));return(0,b.onSnapshot)(f,b=>{a(b.docs.map(a=>({id:a.id,...a.data(),dates:{registrationStart:e(a.data().dates?.registrationStart),registrationEnd:e(a.data().dates?.registrationEnd),eventDate:e(a.data().dates?.eventDate)},createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)})))})}},"rewardsService",0,{async getAll(){let a=(0,b.query)((0,b.collection)(c.db,"rewards"),(0,b.where)("isActive","==",!0));return(await (0,b.getDocs)(a)).docs.map(a=>({id:a.id,...a.data(),expiresAt:e(a.data().expiresAt),createdAt:e(a.data().createdAt)})).sort((a,b)=>a.xpCost-b.xpCost)},getPartners:async()=>(await (0,b.getDocs)((0,b.collection)(c.db,"partners"))).docs.map(a=>({id:a.id,...a.data(),createdAt:e(a.data().createdAt)})),async redeem(a,d,e){let f=await (0,b.addDoc)((0,b.collection)(c.db,"claims"),{rewardId:a,studentId:d,xpCost:e,claimedAt:b.Timestamp.now(),status:"active"}),g=(0,b.doc)(c.db,"rewards",a);return await (0,b.updateDoc)(g,{claimCount:(0,b.increment)(1)}),f.id}},"schoolDemosService",0,i,"settingsService",0,{async getOpportunityTypes(){let a=(0,b.doc)(c.db,d.settings,"opportunityTypes"),e=await (0,b.getDoc)(a);return e.exists()&&e.data().types||[]},async saveOpportunityTypes(a){let e=(0,b.doc)(c.db,d.settings,"opportunityTypes");await (0,b.updateDoc)(e,{types:a})},async getGrades(){let a=(0,b.doc)(c.db,d.settings,"grades"),e=await (0,b.getDoc)(a);return e.exists()?e.data().grades||[]:[6,7,8,9,10,11,12]},async saveGrades(a){let e=(0,b.doc)(c.db,d.settings,"grades");await (0,b.updateDoc)(e,{grades:a})},async getTags(){let a=(0,b.doc)(c.db,d.settings,"tags"),e=await (0,b.getDoc)(a);return e.exists()&&e.data().tags||[]},async saveTags(a){let e=(0,b.doc)(c.db,d.settings,"tags");await (0,b.updateDoc)(e,{tags:a})},getOrganizers:async()=>(await (0,b.getDocs)((0,b.collection)(c.db,d.organizers))).docs.map(a=>({id:a.id,...a.data(),createdAt:e(a.data().createdAt),updatedAt:e(a.data().updatedAt)})),saveOrganizer:async a=>(await (0,b.addDoc)((0,b.collection)(c.db,d.organizers),g({...a,createdAt:b.Timestamp.now(),updatedAt:b.Timestamp.now()}))).id,async deleteOrganizer(a){await (0,b.deleteDoc)((0,b.doc)(c.db,d.organizers,a))}},"studentsService",0,h])}];

//# sourceMappingURL=src_lib_firestore_ts_d539f8e1._.js.map